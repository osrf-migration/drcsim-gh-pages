{"links": {"self": {"href": "data/repositories/osrf/sandia-hand/issues/17/comments/7018613.json"}, "html": {"href": "#!/osrf/sandia-hand/issues/17#comment-7018613"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/sandia-hand/issues/17.json"}}, "type": "issue", "id": 17, "repository": {"links": {"self": {"href": "data/repositories/osrf/sandia-hand.json"}, "html": {"href": "#!/osrf/sandia-hand"}, "avatar": {"href": "data/bytebucket.org/ravatar/{ffa260f4-e54c-4b4b-ab64-4d0fc5a90091}ts=default"}}, "type": "repository", "name": "sandia-hand", "full_name": "osrf/sandia-hand", "uuid": "{ffa260f4-e54c-4b4b-ab64-4d0fc5a90091}"}, "title": "what do fmcb_temp and mobo_temp mean?"}, "content": {"raw": "Hi Ryohei,\n\nI had forgotten all of this.\n\nThe schematics for the finger motor controller (fmcb) board are here:\nhttp://wiki.osrfoundation.org/SandiaHand/Overview/Electrical?action=AttachFile&do=view&target=fmcb.pdf\n\nand the firmware tree is here:\n#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/?at=default\n\nThe fmcb_temp array is populated on lines 367-369 here:\n#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/pb.c?at=default\n\nthe first element of fmcb_temp is from g_i2c_sensors_data[0] in this file,\nlines 106-108:\n#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/i2c_sensors.c?at=default\nIt is the best sensor (by far) of the finger motor controller board\ntemperature: a MCP9804 temperature sensor.\n\nthe second element of fmcb_temp comes from g_i2c_sensors_data[7] in that\nfile, lines 116-117, which comes from the on-chip temperature sensor from\nthe LSM303DLHC accelerometer on the board.\n\nthe third element of fmcb_temp is the on-chip SAM3S temperature sensor. It\nhas a lot of noise and offset, and I wouldn't recommend using it.\n\nTo convert the first element to Celsius, the MCP9804 datasheet is useful\n(see table 5-1):\nhttp://ww1.microchip.com/downloads/en/DeviceDoc/22203b.pdf\n\nmask it with 0xfff and then right-shift the result 4 bits.\n\nFor example, with the reading you showed of 50374:\n\n50374 = 0xC4C6\n0xC4C6 & 0xFFF = 0x4C6\n0x4C6 >> 4 = 76.375 in decimal\n\nwhich should be an accurate measurement of the temperature of the finger\nmotor controller PCB in the vicinity of the temperature sensor.\n\nI'll need to dive into the mobo schematics and firmware to figure out\nwhat's happening there.\n", "markup": "markdown", "html": "<p>Hi Ryohei,</p>\n<p>I had forgotten all of this.</p>\n<p>The schematics for the finger motor controller (fmcb) board are here:\n<a href=\"http://wiki.osrfoundation.org/SandiaHand/Overview/Electrical?action=AttachFile&amp;do=view&amp;target=fmcb.pdf\" rel=\"nofollow\" class=\"ap-connect-link\">http://wiki.osrfoundation.org/SandiaHand/Overview/Electrical?action=AttachFile&amp;do=view&amp;target=fmcb.pdf</a></p>\n<p>and the firmware tree is here:\n<a href=\"#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/?at=default\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/?at=default</a></p>\n<p>The fmcb_temp array is populated on lines 367-369 here:\n<a href=\"#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/pb.c?at=default\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/pb.c?at=default</a></p>\n<p>the first element of fmcb_temp is from g_i2c_sensors_data[0] in this file,\nlines 106-108:\n<a href=\"#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/i2c_sensors.c?at=default\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/sandia-hand/src/0d6c9231a2ed390185b5861fa2e8a9edad92f358/firmware/fmcb/std/i2c_sensors.c?at=default</a>\nIt is the best sensor (by far) of the finger motor controller board\ntemperature: a MCP9804 temperature sensor.</p>\n<p>the second element of fmcb_temp comes from g_i2c_sensors_data[7] in that\nfile, lines 116-117, which comes from the on-chip temperature sensor from\nthe LSM303DLHC accelerometer on the board.</p>\n<p>the third element of fmcb_temp is the on-chip SAM3S temperature sensor. It\nhas a lot of noise and offset, and I wouldn't recommend using it.</p>\n<p>To convert the first element to Celsius, the MCP9804 datasheet is useful\n(see table 5-1):\n<a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/22203b.pdf\" rel=\"nofollow\" class=\"ap-connect-link\">http://ww1.microchip.com/downloads/en/DeviceDoc/22203b.pdf</a></p>\n<p>mask it with 0xfff and then right-shift the result 4 bits.</p>\n<p>For example, with the reading you showed of 50374:</p>\n<p>50374 = 0xC4C6\n0xC4C6 &amp; 0xFFF = 0x4C6\n0x4C6 &gt;&gt; 4 = 76.375 in decimal</p>\n<p>which should be an accurate measurement of the temperature of the finger\nmotor controller PCB in the vicinity of the temperature sensor.</p>\n<p>I'll need to dive into the mobo schematics and firmware to figure out\nwhat's happening there.</p>", "type": "rendered"}, "created_on": "2013-11-22T19:30:15.111316+00:00", "user": {"display_name": "Morgan Quigley", "uuid": "{92f5a4e9-2e82-42b7-955b-3eda9a272364}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B92f5a4e9-2e82-42b7-955b-3eda9a272364%7D"}, "html": {"href": "https://bitbucket.org/%7B92f5a4e9-2e82-42b7-955b-3eda9a272364%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/c40268cda48633a945ef88a3f37da8dcd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMQ-4.png"}}, "nickname": "Morgan Quigley", "type": "user", "account_id": "557058:6d82cad4-6685-41dd-9e43-f2af8c287dbb"}, "updated_on": null, "type": "issue_comment", "id": 7018613}