{"links": {"self": {"href": "data/repositories/osrf/drcsim/issues/343/comments/6904294.json"}, "html": {"href": "#!/osrf/drcsim/issues/343#comment-6904294"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/drcsim/issues/343.json"}}, "type": "issue", "id": 343, "repository": {"links": {"self": {"href": "data/repositories/osrf/drcsim.json"}, "html": {"href": "#!/osrf/drcsim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{247b5408-ae91-4e3c-b2f9-a21994658d11}ts=c_plus_plus"}}, "type": "repository", "name": "drcsim", "full_name": "osrf/drcsim", "uuid": "{247b5408-ae91-4e3c-b2f9-a21994658d11}"}, "title": "Remove `k_effort` from `atlas_msgs` to match `AtlasRobotInterface`"}, "content": {"raw": "One option is to change implementation of [AtlasPlugin::SetAtlasCommand](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_gazebo_ros_plugins/src/AtlasPlugin.cpp?at=default#cl-930) such that if [`set_desired_behavior(\"User\")`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterface.h?at=default#cl-152), then switch to individual joint control (equivalent to `k_effort = 255`) using commands from [`AtlasJointDesired`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-80) and [`AtlasJointControlParams`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-120) with the following mapping:\n\n *  [`atlas_msgs::position`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-21) is implemented by [`AtlasJointDesired::q_d`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-82)\n *  [`atlas_msgs::velocity`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-22) is implemented by [`AtlasJointDesired::qd_d`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-83)\n *  [`atlas_msgs::effort`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-23) is implemented by [`AtlasJointDesired::f_d`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-84)\n * [`atlas_msgs::kp_position`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-25) is implemented by [`AtlasJointControlParams::k_q_p`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-122)\n * [`atlas_msgs::ki_position`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-26) is implemented by [`AtlasJointControlParams::k_q_i`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-123)\n * [`atlas_msgs::kd_position`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-27) is ignored.\n * [`atlas_msgs::kp_velocity`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-28) is implemented by [`AtlasJointControlParams::k_qd_p`](#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-124)\n \nWhile `set_desired_behavior(\"[...not User...]\")` controls the robot by behavior library, equivalent to setting `k_effort` to 0.", "markup": "markdown", "html": "<p>One option is to change implementation of <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_gazebo_ros_plugins/src/AtlasPlugin.cpp?at=default#cl-930\" rel=\"nofollow\">AtlasPlugin::SetAtlasCommand</a> such that if <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterface.h?at=default#cl-152\" rel=\"nofollow\"><code>set_desired_behavior(\"User\")</code></a>, then switch to individual joint control (equivalent to <code>k_effort = 255</code>) using commands from <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-80\" rel=\"nofollow\"><code>AtlasJointDesired</code></a> and <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-120\" rel=\"nofollow\"><code>AtlasJointControlParams</code></a> with the following mapping:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-21\" rel=\"nofollow\"><code>atlas_msgs::position</code></a> is implemented by <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-82\" rel=\"nofollow\"><code>AtlasJointDesired::q_d</code></a></li>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-22\" rel=\"nofollow\"><code>atlas_msgs::velocity</code></a> is implemented by <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-83\" rel=\"nofollow\"><code>AtlasJointDesired::qd_d</code></a></li>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-23\" rel=\"nofollow\"><code>atlas_msgs::effort</code></a> is implemented by <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-84\" rel=\"nofollow\"><code>AtlasJointDesired::f_d</code></a></li>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-25\" rel=\"nofollow\"><code>atlas_msgs::kp_position</code></a> is implemented by <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-122\" rel=\"nofollow\"><code>AtlasJointControlParams::k_q_p</code></a></li>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-26\" rel=\"nofollow\"><code>atlas_msgs::ki_position</code></a> is implemented by <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-123\" rel=\"nofollow\"><code>AtlasJointControlParams::k_q_i</code></a></li>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-27\" rel=\"nofollow\"><code>atlas_msgs::kd_position</code></a> is ignored.</li>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/atlas_msgs/msg/AtlasCommand.msg?at=default#cl-28\" rel=\"nofollow\"><code>atlas_msgs::kp_velocity</code></a> is implemented by <a data-is-external-link=\"true\" href=\"#!/osrf/drcsim/src/be43cd53fa1eb192e594ebf4f057406a6b86afc3/drcsim_model_resources/AtlasSimInterface_1.1.1/include/AtlasSimInterface_1.1.1/AtlasSimInterfaceTypes.h?at=default#cl-124\" rel=\"nofollow\"><code>AtlasJointControlParams::k_qd_p</code></a></li>\n</ul>\n<p>While <code>set_desired_behavior(\"[...not User...]\")</code> controls the robot by behavior library, equivalent to setting <code>k_effort</code> to 0.</p>", "type": "rendered"}, "created_on": "2013-11-15T01:14:15.941686+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "updated_on": null, "type": "issue_comment", "id": 6904294}