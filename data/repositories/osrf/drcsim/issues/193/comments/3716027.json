{"links": {"self": {"href": "data/repositories/osrf/drcsim/issues/193/comments/3716027.json"}, "html": {"href": "#!/osrf/drcsim/issues/193#comment-3716027"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/drcsim/issues/193.json"}}, "type": "issue", "id": 193, "repository": {"links": {"self": {"href": "data/repositories/osrf/drcsim.json"}, "html": {"href": "#!/osrf/drcsim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{247b5408-ae91-4e3c-b2f9-a21994658d11}ts=c_plus_plus"}}, "type": "repository", "name": "drcsim", "full_name": "osrf/drcsim", "uuid": "{247b5408-ae91-4e3c-b2f9-a21994658d11}"}, "title": "Force Torque sensor does not give correct results for torque and is extremely noisy"}, "content": {"raw": "one possibility is improper handling of joint pose transform, can you try with world file below, where I shifted the model so joint frame are collocated with child link frame, and see if the resulting torques are correct?\n~~~\n<?xml version=\"1.0\" ?>\n<sdf version=\"1.4\">\n    <world name=\"default\">\n        <plugin name=\"SimpleWorldController\" filename=\"libSimpleWorldController.so\" />\n        <!-- Ground Plane -->\n        <include>\n            <uri>model://ground_plane</uri>\n        </include>\n        <include>\n            <uri>model://sun</uri>\n        </include>\n        <model name=\"box\">\n            <pose>0 0 0 0 0 0</pose>\n            <link name=\"link\">\n                <collision name=\"collision\">\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <geometry>\n                        <box>\n                            <size>1 1 1</size>\n                        </box>\n                    </geometry>\n                </collision>\n                <visual name=\"visual\">\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <geometry>\n                        <box>\n                            <size>1 1 1</size>\n                        </box>\n                    </geometry>\n                </visual>\n                <inertial>\n                    <mass>100.0</mass>\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <inertia>\n                        <ixx>0.1</ixx>\n                        <iyy>0.1</iyy>\n                        <izz>0.1</izz>\n                        <ixy>0.1</ixy>\n                        <ixz>0.1</ixz>\n                        <iyz>0.1</iyz>\n                    </inertia>\n                </inertial>\n            </link>\n            <link name=\"link2\">\n                <pose>1.0 0 1.0 0 0 0</pose>\n                <collision name=\"collision\">\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <geometry>\n                        <box>\n                            <size>1 1 1</size>\n                        </box>\n                    </geometry>\n                </collision>\n                <visual name=\"visual\">\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <geometry>\n                        <box>\n                            <size>1 1 1</size>\n                        </box>\n                    </geometry>\n                </visual>\n                <inertial>\n                    <mass>5.0</mass>\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <inertia>\n                        <ixx>0.1</ixx>\n                        <iyy>0.1</iyy>\n                        <izz>0.1</izz>\n                        <ixy>0.1</ixy>\n                        <ixz>0.1</ixz>\n                        <iyz>0.1</iyz>\n                    </inertia>\n                </inertial>\n            </link>\n            <link name=\"link3\">\n                <pose>2.0 0 2.0 0 0 0</pose>\n                <collision name=\"collision\">\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <geometry>\n                        <box>\n                            <size>1 1 1</size>\n                        </box>\n                    </geometry>\n                </collision>\n                <visual name=\"visual\">\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <geometry>\n                        <box>\n                            <size>1 1 1</size>\n                        </box>\n                    </geometry>\n                </visual>\n                <inertial>\n                    <mass>1.0</mass>\n                    <pose>0.5 0 0.5 0 0 0</pose>\n                    <inertia>\n                        <ixx>0.1</ixx>\n                        <iyy>0.1</iyy>\n                        <izz>0.1</izz>\n                        <ixy>0.1</ixy>\n                        <ixz>0.1</ixz>\n                        <iyz>0.1</iyz>\n                    </inertia>\n                </inertial>\n            </link>\n            <joint name=\"joint1\" type=\"revolute\">\n                <physics>\n                    <ode>\n                        <provide_feedback>true</provide_feedback>\n                    </ode>\n                </physics>\n                <axis>\n                    <xyz>0 1 0</xyz>\n                </axis>\n                <parent>\n                    <link_name>link</link_name>\n                </parent>\n                <child>\n                    <link_name>link2</link_name>\n                </child>\n            </joint>\n            <joint name=\"joint2\" type=\"revolute\">\n                <physics>\n                    <ode>\n                        <provide_feedback>true</provide_feedback>\n                    </ode>\n                </physics>\n                <axis>\n                    <xyz>0 1 0</xyz>\n                </axis>\n                <parent>\n                    <link_name>link2</link_name>\n                </parent>\n                <child>\n                    <link_name>link3</link_name>\n                </child>\n            </joint>\n            <!--<plugin name=\"GazeboJointControlTester\" filename=\"libGazeboJointControlTester.so\">\n      </plugin>-->\n            <plugin name=\"GazeboStateCommunicator\" filename=\"libGazeboStateCommunicator.so\" imulink=\"imu_link\" />\n        </model>\n        <physics type=\"ode\">\n            <gravity>0.000000 0.000000 -9.800000</gravity>\n            <ode>\n                <solver>\n                    <iters>1500</iters>\n                </solver>\n            </ode>\n            <real_time_update_rate>10000.000000</real_time_update_rate>\n            <max_step_size>0.0001</max_step_size>\n        </physics>\n    </world>\n</sdf>\n~~~\nThanks.", "markup": "markdown", "html": "<p>one possibility is improper handling of joint pose transform, can you try with world file below, where I shifted the model so joint frame are collocated with child link frame, and see if the resulting torques are correct?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>\n<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&quot;1.4&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;world</span> <span class=\"na\">name=</span><span class=\"s\">&quot;default&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;plugin</span> <span class=\"na\">name=</span><span class=\"s\">&quot;SimpleWorldController&quot;</span> <span class=\"na\">filename=</span><span class=\"s\">&quot;libSimpleWorldController.so&quot;</span> <span class=\"nt\">/&gt;</span>\n        <span class=\"c\">&lt;!-- Ground Plane --&gt;</span>\n        <span class=\"nt\">&lt;include&gt;</span>\n            <span class=\"nt\">&lt;uri&gt;</span>model://ground_plane<span class=\"nt\">&lt;/uri&gt;</span>\n        <span class=\"nt\">&lt;/include&gt;</span>\n        <span class=\"nt\">&lt;include&gt;</span>\n            <span class=\"nt\">&lt;uri&gt;</span>model://sun<span class=\"nt\">&lt;/uri&gt;</span>\n        <span class=\"nt\">&lt;/include&gt;</span>\n        <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box&quot;</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;pose&gt;</span>0 0 0 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n            <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;geometry&gt;</span>\n                        <span class=\"nt\">&lt;box&gt;</span>\n                            <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n                        <span class=\"nt\">&lt;/box&gt;</span>\n                    <span class=\"nt\">&lt;/geometry&gt;</span>\n                <span class=\"nt\">&lt;/collision&gt;</span>\n                <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;geometry&gt;</span>\n                        <span class=\"nt\">&lt;box&gt;</span>\n                            <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n                        <span class=\"nt\">&lt;/box&gt;</span>\n                    <span class=\"nt\">&lt;/geometry&gt;</span>\n                <span class=\"nt\">&lt;/visual&gt;</span>\n                <span class=\"nt\">&lt;inertial&gt;</span>\n                    <span class=\"nt\">&lt;mass&gt;</span>100.0<span class=\"nt\">&lt;/mass&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;inertia&gt;</span>\n                        <span class=\"nt\">&lt;ixx&gt;</span>0.1<span class=\"nt\">&lt;/ixx&gt;</span>\n                        <span class=\"nt\">&lt;iyy&gt;</span>0.1<span class=\"nt\">&lt;/iyy&gt;</span>\n                        <span class=\"nt\">&lt;izz&gt;</span>0.1<span class=\"nt\">&lt;/izz&gt;</span>\n                        <span class=\"nt\">&lt;ixy&gt;</span>0.1<span class=\"nt\">&lt;/ixy&gt;</span>\n                        <span class=\"nt\">&lt;ixz&gt;</span>0.1<span class=\"nt\">&lt;/ixz&gt;</span>\n                        <span class=\"nt\">&lt;iyz&gt;</span>0.1<span class=\"nt\">&lt;/iyz&gt;</span>\n                    <span class=\"nt\">&lt;/inertia&gt;</span>\n                <span class=\"nt\">&lt;/inertial&gt;</span>\n            <span class=\"nt\">&lt;/link&gt;</span>\n            <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link2&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;pose&gt;</span>1.0 0 1.0 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;geometry&gt;</span>\n                        <span class=\"nt\">&lt;box&gt;</span>\n                            <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n                        <span class=\"nt\">&lt;/box&gt;</span>\n                    <span class=\"nt\">&lt;/geometry&gt;</span>\n                <span class=\"nt\">&lt;/collision&gt;</span>\n                <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;geometry&gt;</span>\n                        <span class=\"nt\">&lt;box&gt;</span>\n                            <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n                        <span class=\"nt\">&lt;/box&gt;</span>\n                    <span class=\"nt\">&lt;/geometry&gt;</span>\n                <span class=\"nt\">&lt;/visual&gt;</span>\n                <span class=\"nt\">&lt;inertial&gt;</span>\n                    <span class=\"nt\">&lt;mass&gt;</span>5.0<span class=\"nt\">&lt;/mass&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;inertia&gt;</span>\n                        <span class=\"nt\">&lt;ixx&gt;</span>0.1<span class=\"nt\">&lt;/ixx&gt;</span>\n                        <span class=\"nt\">&lt;iyy&gt;</span>0.1<span class=\"nt\">&lt;/iyy&gt;</span>\n                        <span class=\"nt\">&lt;izz&gt;</span>0.1<span class=\"nt\">&lt;/izz&gt;</span>\n                        <span class=\"nt\">&lt;ixy&gt;</span>0.1<span class=\"nt\">&lt;/ixy&gt;</span>\n                        <span class=\"nt\">&lt;ixz&gt;</span>0.1<span class=\"nt\">&lt;/ixz&gt;</span>\n                        <span class=\"nt\">&lt;iyz&gt;</span>0.1<span class=\"nt\">&lt;/iyz&gt;</span>\n                    <span class=\"nt\">&lt;/inertia&gt;</span>\n                <span class=\"nt\">&lt;/inertial&gt;</span>\n            <span class=\"nt\">&lt;/link&gt;</span>\n            <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link3&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;pose&gt;</span>2.0 0 2.0 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;geometry&gt;</span>\n                        <span class=\"nt\">&lt;box&gt;</span>\n                            <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n                        <span class=\"nt\">&lt;/box&gt;</span>\n                    <span class=\"nt\">&lt;/geometry&gt;</span>\n                <span class=\"nt\">&lt;/collision&gt;</span>\n                <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;geometry&gt;</span>\n                        <span class=\"nt\">&lt;box&gt;</span>\n                            <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n                        <span class=\"nt\">&lt;/box&gt;</span>\n                    <span class=\"nt\">&lt;/geometry&gt;</span>\n                <span class=\"nt\">&lt;/visual&gt;</span>\n                <span class=\"nt\">&lt;inertial&gt;</span>\n                    <span class=\"nt\">&lt;mass&gt;</span>1.0<span class=\"nt\">&lt;/mass&gt;</span>\n                    <span class=\"nt\">&lt;pose&gt;</span>0.5 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n                    <span class=\"nt\">&lt;inertia&gt;</span>\n                        <span class=\"nt\">&lt;ixx&gt;</span>0.1<span class=\"nt\">&lt;/ixx&gt;</span>\n                        <span class=\"nt\">&lt;iyy&gt;</span>0.1<span class=\"nt\">&lt;/iyy&gt;</span>\n                        <span class=\"nt\">&lt;izz&gt;</span>0.1<span class=\"nt\">&lt;/izz&gt;</span>\n                        <span class=\"nt\">&lt;ixy&gt;</span>0.1<span class=\"nt\">&lt;/ixy&gt;</span>\n                        <span class=\"nt\">&lt;ixz&gt;</span>0.1<span class=\"nt\">&lt;/ixz&gt;</span>\n                        <span class=\"nt\">&lt;iyz&gt;</span>0.1<span class=\"nt\">&lt;/iyz&gt;</span>\n                    <span class=\"nt\">&lt;/inertia&gt;</span>\n                <span class=\"nt\">&lt;/inertial&gt;</span>\n            <span class=\"nt\">&lt;/link&gt;</span>\n            <span class=\"nt\">&lt;joint</span> <span class=\"na\">name=</span><span class=\"s\">&quot;joint1&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;revolute&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;physics&gt;</span>\n                    <span class=\"nt\">&lt;ode&gt;</span>\n                        <span class=\"nt\">&lt;provide_feedback&gt;</span>true<span class=\"nt\">&lt;/provide_feedback&gt;</span>\n                    <span class=\"nt\">&lt;/ode&gt;</span>\n                <span class=\"nt\">&lt;/physics&gt;</span>\n                <span class=\"nt\">&lt;axis&gt;</span>\n                    <span class=\"nt\">&lt;xyz&gt;</span>0 1 0<span class=\"nt\">&lt;/xyz&gt;</span>\n                <span class=\"nt\">&lt;/axis&gt;</span>\n                <span class=\"nt\">&lt;parent&gt;</span>\n                    <span class=\"nt\">&lt;link_name&gt;</span>link<span class=\"nt\">&lt;/link_name&gt;</span>\n                <span class=\"nt\">&lt;/parent&gt;</span>\n                <span class=\"nt\">&lt;child&gt;</span>\n                    <span class=\"nt\">&lt;link_name&gt;</span>link2<span class=\"nt\">&lt;/link_name&gt;</span>\n                <span class=\"nt\">&lt;/child&gt;</span>\n            <span class=\"nt\">&lt;/joint&gt;</span>\n            <span class=\"nt\">&lt;joint</span> <span class=\"na\">name=</span><span class=\"s\">&quot;joint2&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;revolute&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;physics&gt;</span>\n                    <span class=\"nt\">&lt;ode&gt;</span>\n                        <span class=\"nt\">&lt;provide_feedback&gt;</span>true<span class=\"nt\">&lt;/provide_feedback&gt;</span>\n                    <span class=\"nt\">&lt;/ode&gt;</span>\n                <span class=\"nt\">&lt;/physics&gt;</span>\n                <span class=\"nt\">&lt;axis&gt;</span>\n                    <span class=\"nt\">&lt;xyz&gt;</span>0 1 0<span class=\"nt\">&lt;/xyz&gt;</span>\n                <span class=\"nt\">&lt;/axis&gt;</span>\n                <span class=\"nt\">&lt;parent&gt;</span>\n                    <span class=\"nt\">&lt;link_name&gt;</span>link2<span class=\"nt\">&lt;/link_name&gt;</span>\n                <span class=\"nt\">&lt;/parent&gt;</span>\n                <span class=\"nt\">&lt;child&gt;</span>\n                    <span class=\"nt\">&lt;link_name&gt;</span>link3<span class=\"nt\">&lt;/link_name&gt;</span>\n                <span class=\"nt\">&lt;/child&gt;</span>\n            <span class=\"nt\">&lt;/joint&gt;</span>\n            <span class=\"c\">&lt;!--&lt;plugin name=&quot;GazeboJointControlTester&quot; filename=&quot;libGazeboJointControlTester.so&quot;&gt;</span>\n<span class=\"c\">      &lt;/plugin&gt;--&gt;</span>\n            <span class=\"nt\">&lt;plugin</span> <span class=\"na\">name=</span><span class=\"s\">&quot;GazeboStateCommunicator&quot;</span> <span class=\"na\">filename=</span><span class=\"s\">&quot;libGazeboStateCommunicator.so&quot;</span> <span class=\"na\">imulink=</span><span class=\"s\">&quot;imu_link&quot;</span> <span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/model&gt;</span>\n        <span class=\"nt\">&lt;physics</span> <span class=\"na\">type=</span><span class=\"s\">&quot;ode&quot;</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;gravity&gt;</span>0.000000 0.000000 -9.800000<span class=\"nt\">&lt;/gravity&gt;</span>\n            <span class=\"nt\">&lt;ode&gt;</span>\n                <span class=\"nt\">&lt;solver&gt;</span>\n                    <span class=\"nt\">&lt;iters&gt;</span>1500<span class=\"nt\">&lt;/iters&gt;</span>\n                <span class=\"nt\">&lt;/solver&gt;</span>\n            <span class=\"nt\">&lt;/ode&gt;</span>\n            <span class=\"nt\">&lt;real_time_update_rate&gt;</span>10000.000000<span class=\"nt\">&lt;/real_time_update_rate&gt;</span>\n            <span class=\"nt\">&lt;max_step_size&gt;</span>0.0001<span class=\"nt\">&lt;/max_step_size&gt;</span>\n        <span class=\"nt\">&lt;/physics&gt;</span>\n    <span class=\"nt\">&lt;/world&gt;</span>\n<span class=\"nt\">&lt;/sdf&gt;</span>\n</pre></div>\n\n\n<p>Thanks.</p>", "type": "rendered"}, "created_on": "2013-04-11T21:04:10.084333+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "updated_on": null, "type": "issue_comment", "id": 3716027}