{"priority": "critical", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/drcsim.json"}, "html": {"href": "#!/osrf/drcsim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{247b5408-ae91-4e3c-b2f9-a21994658d11}ts=c_plus_plus"}}, "type": "repository", "name": "drcsim", "full_name": "osrf/drcsim", "uuid": "{247b5408-ae91-4e3c-b2f9-a21994658d11}"}, "links": {"attachments": {"href": "data/repositories/osrf/drcsim/issues/325/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/drcsim/issues/325.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/drcsim/issues/325/watch"}, "comments": {"href": "data/repositories/osrf/drcsim/issues/325/comments_page=1.json"}, "html": {"href": "#!/osrf/drcsim/issues/325/problem-with-bdi-step-mode"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/drcsim/issues/325/vote"}}, "reporter": {"display_name": "Richard Stilson", "uuid": "{b0e3fea6-84dd-4d6d-8a30-6e1b7ed3b02b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bb0e3fea6-84dd-4d6d-8a30-6e1b7ed3b02b%7D"}, "html": {"href": "https://bitbucket.org/%7Bb0e3fea6-84dd-4d6d-8a30-6e1b7ed3b02b%7D/"}, "avatar": {"href": "https://bitbucket.org/account/GoldFinger90210/avatar/"}}, "nickname": "GoldFinger90210", "type": "user", "account_id": null}, "title": "Problem with BDI Step Mode", "component": null, "votes": 0, "watches": 3, "content": {"raw": "I have found that the drcsim robot instantly freezes when I enter BDI step control mode under certain circumstances. First, the circumstances in which it works successfully\r\n* If I start with zero heading, do dynamic walking, and either maintain the zero heading, or turn during dynamic walking then turn again back to a zero heading, I can reenter step mode (qual 1 fits this pattern)\r\n* If I use step mode to turn to a different heading, then do dynamic walking along that same heading, then stop, I can reenter step mode (ex. step to .78 heading, begin dynamic walking at .78 heading, then stop and reenter stepping mode still at .78 heading)\r\n* If I use step mode to turn to a different heading, then do dynamic walking, in which I turn, but then turn back to end up at the same heading at which I last finished step mode, I can reenter step mode (ex. step to .78 rad heading, begin dynamic walking, turn to 1.57 heading, then turn back to .78 heading, then stop and reenter stepping mode)\r\n\r\nHowever, if I do the following, the robot instantly freezes and falls over\r\n* Start with stepping and finish on any heading, do dynamic walking and turn to a different heading, then attempt to step\r\n*  Ex.  Start with 0 heading, dynamic walk to .78 heading, stop and attempt stepping with instant fail\r\n*  Ex. Start by stepping to .78 heading, dynamic walk to 0 heading, stop and attempt stepping with instant fail\r\n*  Ex. Start directly into dynamic walking, turn to any non-zero heading, stop and attempt stepping with instant fail\r\n\r\nIt appears to me that the stepping routine remembers its previous heading, and the robot can only reenter step mode if it is at the same heading as it was when it previously ended step mode. This also seems to apply even when the robot never entered step mode after starting the sim\r\n\r\nWhen this error occurs, there are no warning message from the AtlasSimInterfaceState error flag, or the status flags for behavior feedback, walk feedback, or step feedback. The behavior feedback flag simply goes to 256 instantly. I have examined the step data I command and it is perfectly sensible in each case that results in falling. Note: I am able to reenter step mode at any heading. It just has to be a heading I previously achieved by rotating in step mode. Even if the steps were not well positioned, I would expect the robot to attempt the step and fail, rather than just instantly going stiff and falling.\r\n\r\nAt this point the only work around I can see is to ensure that if I try to enter step mode, my heading is the same as the last time I was in step mode, or if this is the first time in step mode, my heading must be zero.\r\nObviously I'd like to be able to enter step mode at an arbitrary heading after dynamic walking\r\n\r\nHopefully this can be fixed easily, since the nature of the error is so specific\r\n\r\nI have tested this with the latest version of the drcsim software released today.", "markup": "markdown", "html": "<p>I have found that the drcsim robot instantly freezes when I enter BDI step control mode under certain circumstances. First, the circumstances in which it works successfully\n<em> If I start with zero heading, do dynamic walking, and either maintain the zero heading, or turn during dynamic walking then turn again back to a zero heading, I can reenter step mode (qual 1 fits this pattern)\n</em> If I use step mode to turn to a different heading, then do dynamic walking along that same heading, then stop, I can reenter step mode (ex. step to .78 heading, begin dynamic walking at .78 heading, then stop and reenter stepping mode still at .78 heading)\n* If I use step mode to turn to a different heading, then do dynamic walking, in which I turn, but then turn back to end up at the same heading at which I last finished step mode, I can reenter step mode (ex. step to .78 rad heading, begin dynamic walking, turn to 1.57 heading, then turn back to .78 heading, then stop and reenter stepping mode)</p>\n<p>However, if I do the following, the robot instantly freezes and falls over\n<em> Start with stepping and finish on any heading, do dynamic walking and turn to a different heading, then attempt to step\n</em>  Ex.  Start with 0 heading, dynamic walk to .78 heading, stop and attempt stepping with instant fail\n<em>  Ex. Start by stepping to .78 heading, dynamic walk to 0 heading, stop and attempt stepping with instant fail\n</em>  Ex. Start directly into dynamic walking, turn to any non-zero heading, stop and attempt stepping with instant fail</p>\n<p>It appears to me that the stepping routine remembers its previous heading, and the robot can only reenter step mode if it is at the same heading as it was when it previously ended step mode. This also seems to apply even when the robot never entered step mode after starting the sim</p>\n<p>When this error occurs, there are no warning message from the AtlasSimInterfaceState error flag, or the status flags for behavior feedback, walk feedback, or step feedback. The behavior feedback flag simply goes to 256 instantly. I have examined the step data I command and it is perfectly sensible in each case that results in falling. Note: I am able to reenter step mode at any heading. It just has to be a heading I previously achieved by rotating in step mode. Even if the steps were not well positioned, I would expect the robot to attempt the step and fail, rather than just instantly going stiff and falling.</p>\n<p>At this point the only work around I can see is to ensure that if I try to enter step mode, my heading is the same as the last time I was in step mode, or if this is the first time in step mode, my heading must be zero.\nObviously I'd like to be able to enter step mode at an arbitrary heading after dynamic walking</p>\n<p>Hopefully this can be fixed easily, since the nature of the error is so specific</p>\n<p>I have tested this with the latest version of the drcsim software released today.</p>", "type": "rendered"}, "assignee": null, "state": "duplicate", "version": null, "edited_on": null, "created_on": "2013-06-10T05:57:18.329024+00:00", "milestone": null, "updated_on": "2013-06-10T19:26:47.802044+00:00", "type": "issue", "id": 325}