{"links": {"self": {"href": "data/repositories/osrf/drcsim/pullrequests/311/comments/262036.json"}, "html": {"href": "#!/osrf/drcsim/pull-requests/311/_/diff#comment-262036"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 311, "links": {"self": {"href": "data/repositories/osrf/drcsim/pullrequests/311.json"}, "html": {"href": "#!/osrf/drcsim/pull-requests/311"}}, "title": "add slider teleop for drc_vehicle using cheats"}, "content": {"raw": "The exit car doesn't seem to work for me. I tried adding some code to send 'nominal' to atlas/mode, but the buttons are acting weird.\n~~~\ndiff -r 7ac1e149f82e tutorials/atlas_teleop/drc_vehicle_teleop.py\n--- a/tutorials/atlas_teleop/drc_vehicle_teleop.py\tMon May 20 17:57:31 2013 -0700\n+++ b/tutorials/atlas_teleop/drc_vehicle_teleop.py\tMon May 20 19:14:21 2013 -0700\n@@ -5,7 +5,7 @@\n import rospy\n from sensor_msgs.msg import Joy\n from geometry_msgs.msg import Pose\n-from std_msgs.msg import Float64, Int8\n+from std_msgs.msg import Float64, Int8, String\n \n import math\n \n@@ -16,6 +16,7 @@\n         self.joy_sub = rospy.Subscriber('joy', Joy, self.joy_cb)\n         self.robot_enter_car = rospy.Publisher('drc_world/robot_enter_car', Pose)\n         self.robot_exit_car = rospy.Publisher('drc_world/robot_exit_car', Pose)\n+        self.mode = rospy.Publisher('atlas/mode', String)\n         self.brake_pedal = rospy.Publisher('drc_vehicle/brake_pedal/cmd', Float64)\n         self.gas_pedal = rospy.Publisher('drc_vehicle/gas_pedal/cmd', Float64)\n         self.hand_brake = rospy.Publisher('drc_vehicle/hand_brake/cmd', Float64)\n@@ -30,12 +31,15 @@\n \n         self.BUTTON_ENTER_CAR = 0\n         self.BUTTON_EXIT_CAR = 1\n+        self.BUTTON_NOMINAL = 2\n \n     def joy_cb(self, data):\n         if data.buttons[self.BUTTON_ENTER_CAR] == 1:\n             self.robot_enter_car.publish(Pose())\n         elif data.buttons[self.BUTTON_EXIT_CAR] == 1:\n             self.robot_exit_car.publish(Pose())\n+        elif data.buttons[self.BUTTON_NOMINAL] == 1:\n+            self.mode.publish('nominal')\n         else:\n             self.hand_brake.publish(Float64(data.axes[self.AXIS_HAND_BRAKE]))\n             self.brake_pedal.publish(Float64(data.axes[self.AXIS_BRAKE_PEDAL]))\n~~~\nI'll test more tomorrow.", "markup": "markdown", "html": "<p>The exit car doesn't seem to work for me. I tried adding some code to send 'nominal' to atlas/mode, but the buttons are acting weird.</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 7ac1e149f82e tutorials/atlas_teleop/drc_vehicle_teleop.py</span>\n<span class=\"gd\">--- a/tutorials/atlas_teleop/drc_vehicle_teleop.py  Mon May 20 17:57:31 2013 -0700</span>\n<span class=\"gi\">+++ b/tutorials/atlas_teleop/drc_vehicle_teleop.py  Mon May 20 19:14:21 2013 -0700</span>\n<span class=\"gu\">@@ -5,7 +5,7 @@</span>\n import rospy\n from sensor_msgs.msg import Joy\n from geometry_msgs.msg import Pose\n<span class=\"gd\">-from std_msgs.msg import Float64, Int8</span>\n<span class=\"gi\">+from std_msgs.msg import Float64, Int8, String</span>\n\n import math\n\n<span class=\"gu\">@@ -16,6 +16,7 @@</span>\n         self.joy_sub = rospy.Subscriber(&#39;joy&#39;, Joy, self.joy_cb)\n         self.robot_enter_car = rospy.Publisher(&#39;drc_world/robot_enter_car&#39;, Pose)\n         self.robot_exit_car = rospy.Publisher(&#39;drc_world/robot_exit_car&#39;, Pose)\n<span class=\"gi\">+        self.mode = rospy.Publisher(&#39;atlas/mode&#39;, String)</span>\n         self.brake_pedal = rospy.Publisher(&#39;drc_vehicle/brake_pedal/cmd&#39;, Float64)\n         self.gas_pedal = rospy.Publisher(&#39;drc_vehicle/gas_pedal/cmd&#39;, Float64)\n         self.hand_brake = rospy.Publisher(&#39;drc_vehicle/hand_brake/cmd&#39;, Float64)\n<span class=\"gu\">@@ -30,12 +31,15 @@</span>\n\n         self.BUTTON_ENTER_CAR = 0\n         self.BUTTON_EXIT_CAR = 1\n<span class=\"gi\">+        self.BUTTON_NOMINAL = 2</span>\n\n     def joy_cb(self, data):\n         if data.buttons[self.BUTTON_ENTER_CAR] == 1:\n             self.robot_enter_car.publish(Pose())\n         elif data.buttons[self.BUTTON_EXIT_CAR] == 1:\n             self.robot_exit_car.publish(Pose())\n<span class=\"gi\">+        elif data.buttons[self.BUTTON_NOMINAL] == 1:</span>\n<span class=\"gi\">+            self.mode.publish(&#39;nominal&#39;)</span>\n         else:\n             self.hand_brake.publish(Float64(data.axes[self.AXIS_HAND_BRAKE]))\n             self.brake_pedal.publish(Float64(data.axes[self.AXIS_BRAKE_PEDAL]))\n</pre></div>\n\n\n<p>I'll test more tomorrow.</p>", "type": "rendered"}, "created_on": "2013-05-21T02:13:29.979042+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2013-05-21T02:13:29.987708+00:00", "type": "pullrequest_comment", "id": 262036}