{"links": {"self": {"href": "data/repositories/osrf/drcsim/pullrequests/77/comments/91965.json"}, "html": {"href": "#!/osrf/drcsim/pull-requests/77/_/diff#comment-91965"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 77, "links": {"self": {"href": "data/repositories/osrf/drcsim/pullrequests/77.json"}, "html": {"href": "#!/osrf/drcsim/pull-requests/77"}}, "title": "set sim time in ros by ros::Time::setNow() and add doxygen comments"}, "content": {"raw": "Based on discussion with @hsu : \n\nThis patch has the potential to cause time to go backward: we set time manually to t0, publish t0, set time manually t1, publish t1, then some time later we receive the previously published t0, and roscpp sets time to t0.\n\nWe need to figure how to avoid this problem.  First idea is to unsubscribe from \"/clock\".  The subscription happens in roscpp, in `ros_comm/clients/roscpp/src/libros/init.cpp`.  Looks like we could do something like this:\n\n    ros::TopicManager::instance()->unsubscribe(\"/clock\", ...);\n\nBut that second arg needs to be filled in with something that'll match what was provided in the original subscription.  Could be that we need to recreate the structure(s) created during the original subscription.\n\nOther ideas are most welcome.\n", "markup": "markdown", "html": "<p>Based on discussion with @hsu : </p>\n<p>This patch has the potential to cause time to go backward: we set time manually to t0, publish t0, set time manually t1, publish t1, then some time later we receive the previously published t0, and roscpp sets time to t0.</p>\n<p>We need to figure how to avoid this problem.  First idea is to unsubscribe from \"/clock\".  The subscription happens in roscpp, in <code>ros_comm/clients/roscpp/src/libros/init.cpp</code>.  Looks like we could do something like this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">ros</span><span class=\"p\">::</span><span class=\"nd\">TopicManager</span><span class=\"p\">::</span><span class=\"nd\">instance</span><span class=\"o\">()</span><span class=\"nt\">-</span><span class=\"o\">&gt;</span><span class=\"nt\">unsubscribe</span><span class=\"o\">(</span><span class=\"s2\">&quot;/clock&quot;</span><span class=\"o\">,</span> <span class=\"o\">...);</span>\n</pre></div>\n\n\n<p>But that second arg needs to be filled in with something that'll match what was provided in the original subscription.  Could be that we need to recreate the structure(s) created during the original subscription.</p>\n<p>Other ideas are most welcome.</p>", "type": "rendered"}, "created_on": "2013-01-22T18:59:20.842042+00:00", "user": {"display_name": "Brian Gerkey", "uuid": "{3d8b5763-9dad-4be7-85c2-a7ab6cd49173}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d8b5763-9dad-4be7-85c2-a7ab6cd49173%7D"}, "html": {"href": "https://bitbucket.org/%7B3d8b5763-9dad-4be7-85c2-a7ab6cd49173%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2e35028e-9ad8-4d6a-a3a5-275159a304a9/5fa9ec73-0fec-4860-a202-e34ae23b6a12/128"}}, "nickname": "Brian Gerkey", "type": "user", "account_id": "557058:2e35028e-9ad8-4d6a-a3a5-275159a304a9"}, "updated_on": "2013-01-22T18:59:20.859884+00:00", "type": "pullrequest_comment", "id": 91965}