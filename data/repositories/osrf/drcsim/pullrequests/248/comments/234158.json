{"links": {"self": {"href": "data/repositories/osrf/drcsim/pullrequests/248/comments/234158.json"}, "html": {"href": "#!/osrf/drcsim/pull-requests/248/_/diff#comment-234158"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 248, "links": {"self": {"href": "data/repositories/osrf/drcsim/pullrequests/248.json"}, "html": {"href": "#!/osrf/drcsim/pull-requests/248"}}, "title": "per issue #194, alternative solution, add ROS service, allowing user to change joint damping with hard coded per joint bounds"}, "content": {"raw": "It is not clear what your note (or my previous note) refers to. So let me try to fix that. We would like to make the local PD control on the simulator machine useful. The PD controller on the simulator machine doesn't use a state estimator, so state estimation is irrelevant. It just multiplies the D gain times the raw velocity signal (or numerically differentiated position signal, which is just as noisy). A gain of about 100 pumps too much noise into the robot through the torque command. If you are suggesting the ankle pitch gain can be significantly less than 100, here is a counter-argument (which boils down to what time constant you can tolerate).\n\nA local linearization of whatever you do that is smooth boils down to a PD controller, and we can relate the damping and the time constant for a critically damped system: damping = 2 x mass x natural_frequency\nhttp://en.wikipedia.org/wiki/Damping_ratio\n\ncrude argument:\nmass of robot is about 100,\nheight of COM is about 1.\nmoment of inertia of robot about ankle axis is about 100,\ndamping = 2 x moi x w.\nFor w = 1r/s (1/(2pi)Hz), required damping is 200.\n\nslightly more refined argument:\nmass of robot without feet is 95.3057,\ncom_position relative to ankle is\n    0.0153   -0.0897    0.8251,\nI_yy = 12 (estimate),\nmoi_ankle_y = I_yy + mass * (l_x^2 + l_z^2) =\n12 + 95.3057*(0.0153^2 + 0.8251^2) =\n77.\nFor w = 1r/s (1/(2pi)Hz), required damping is 154,\n\nA 1r/s time constant is really too low.\n", "markup": "markdown", "html": "<p>It is not clear what your note (or my previous note) refers to. So let me try to fix that. We would like to make the local PD control on the simulator machine useful. The PD controller on the simulator machine doesn't use a state estimator, so state estimation is irrelevant. It just multiplies the D gain times the raw velocity signal (or numerically differentiated position signal, which is just as noisy). A gain of about 100 pumps too much noise into the robot through the torque command. If you are suggesting the ankle pitch gain can be significantly less than 100, here is a counter-argument (which boils down to what time constant you can tolerate).</p>\n<p>A local linearization of whatever you do that is smooth boils down to a PD controller, and we can relate the damping and the time constant for a critically damped system: damping = 2 x mass x natural_frequency\n<a href=\"http://en.wikipedia.org/wiki/Damping_ratio\" rel=\"nofollow\" class=\"ap-connect-link\">http://en.wikipedia.org/wiki/Damping_ratio</a></p>\n<p>crude argument:\nmass of robot is about 100,\nheight of COM is about 1.\nmoment of inertia of robot about ankle axis is about 100,\ndamping = 2 x moi x w.\nFor w = 1r/s (1/(2pi)Hz), required damping is 200.</p>\n<p>slightly more refined argument:\nmass of robot without feet is 95.3057,\ncom_position relative to ankle is\n    0.0153   -0.0897    0.8251,\nI_yy = 12 (estimate),\nmoi_ankle_y = I_yy + mass * (l_x^2 + l_z^2) =\n12 + 95.3057*(0.0153^2 + 0.8251^2) =\n77.\nFor w = 1r/s (1/(2pi)Hz), required damping is 154,</p>\n<p>A 1r/s time constant is really too low.</p>", "type": "rendered"}, "created_on": "2013-05-03T21:21:10.058473+00:00", "user": {"display_name": "Chris Atkeson", "uuid": "{3bdaa162-b747-4fa9-9d6e-a2d5c92933c6}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3bdaa162-b747-4fa9-9d6e-a2d5c92933c6%7D"}, "html": {"href": "https://bitbucket.org/%7B3bdaa162-b747-4fa9-9d6e-a2d5c92933c6%7D/"}, "avatar": {"href": "https://bitbucket.org/account/catkeson/avatar/"}}, "nickname": "catkeson", "type": "user", "account_id": null}, "updated_on": "2013-05-03T21:27:00.643510+00:00", "type": "pullrequest_comment", "id": 234158}